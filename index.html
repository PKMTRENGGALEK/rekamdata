<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
    crossorigin="anonymous"
  />
  <link rel="stylesheet" href="style.css" />
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://code.jquery.com/jquery-3.7.1.js"
    integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"
  ></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link
  href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdn.jsdelivr.net/npm/@ttskch/select2-bootstrap4-theme@1.5.2/dist/select2-bootstrap4.min.css"
  rel="stylesheet"
/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
  <div class="container register shadow">
    <div class="row">
      
      <div class="col-md-3 register-left ">
        <!-- <img src="tb.png" alt="" style="width: 150px" /> -->
        <img src="pkmlogo.png">
        <h3>INOVASI AGEN KRIBO</h3>
        <div class="row">
          
          <div class="col">
            <img src="kribo.png" >
          </div>
          <div class="col">
            <img src="gg.png" >
          </div>
        </div>
         
        
        <!-- <p>Register Data TBC</p> -->
<!--         <a href="https://docs.google.com/spreadsheets/d/1yz-l4LgNSHl6DGpX0hsWABsD2BS4y4NM8AlT8XJ2GPs/edit?usp=sharing" class="btn btn-me shadow text-white mb-2"> View Data Input</a> -->
      </div>
      <div class="col-md-9 register-right">
        
        <div class="tab-content" id="myTabContent">
          <div
            class="tab-pane fade show active"
            id="home"
            role="tabpanel"
            aria-labelledby="home-tab"
          >
          <div class="register-heading">
            
            <h2>
              Data Suspect TBC
            </h2>
          </div>
            
            <form name="submit-to-google-sheet">
              
              <div class="row register-form">
                  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                      <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                      </symbol>
                      <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                      </symbol>
                      <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                      </symbol>
                    </svg>
                  <div class="alert alert-success d-flex align-items-center shadow d-none" role="alert">
                      <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="#check-circle-fill"/></svg>
                      <div>
                               Terimakasih Data Berhasil Disimpan
                      </div> 
                    </div>
                    
                <div class="col-md-6 mt-2">
                  <label> Pilih Faskes</label>
                  <select name="faskes" id="faskes" class="form-select select2" required>
                    <option value="">-- Pilih Faskes --</option>
                   <option value="Apotik">Apotik</option>
                    <option value="Toko Obat">Toko Obat</option>
                    <option value="Penyehat Tradisional">Penyehat Tradisional</option>
                  </select>
                </div>
                <div class="col-md-6 mt-2">
                  <label> Tanggal </label>
                  <input type="text" id="tanggal" class="form-control" name="tanggal" required />
                </div>
                <div class="col-md-6 mt-2">
                  <label> Nama </label>
                  <input type="text" class="form-control" name="nama" required/>
                </div>
                <div class="col-md-6 mt-2">
                  <label> NIK </label>
                  <input type="text" class="form-control" id="nik" name="nik" required/>
                </div>
                <div class="col-md-6 mt-2">
                  <label> No Telp </label>
                  <input type="number" class="form-control" name="no_telp" required/>
                </div>
              
                <div class="col-md-6 mt-2">
                  <label for="provinsi" class="form-label">Provinsi</label>
                  <select id="provinsi" class="form-select select2" name="provinsi" required>
                    <option value="">Pilih Provinsi</option>
                  </select>
                </div>
                <div class="col-md-6 mt-2">
                  <label for="kabupaten" class="form-label">Kabupaten/Kota</label>
                  <select id="kabupaten" class="form-select select2" name="kabupaten" required>
                    <option value="">Pilih Kabupaten/Kota</option>
                  </select>
                </div>
                <div class="col-md-6 mt-2">
                  <label for="kecamatan" class="form-label">Kecamatan</label>
                  <select id="kecamatan" class="form-select select2" name="kecamatan" required>
                    <option value="">Pilih Kecamatan</option>
                  </select>
                </div>
                <div class="col-md-6 mt-2">
                  <label for="desa" class="form-label">Desa/Kelurahan</label>
                  <select id="desa" class="form-select select2" name="kelurahan" required>
                    <option value="">Pilih Desa/Kelurahan</option>
                  </select>
                </div>
                <div class="col-md-6 mt-2">
                  <label for="rt" class="form-label">RT</label>
                  <input
                    type="text"
                    id="rt"
                    class="form-control"
                    placeholder="Masukkan RT"
                    name="rt"
                    required
                  />
                </div>
                <div class="col-md-6 mt-2">
                  <label for="rw" class="form-label">RW</label>
                  <input
                    type="text"
                    id="rw"
                    class="form-control"
                    placeholder="Masukkan RW"
                    name="rw"
                    required
                  />
                </div>
                <div class="col-md-6 mt-2">
                  <label> Lama Batuk </label>
                  <input type="text" class="form-control" name="lama_batuk" required/>
                </div>
                
                <div class="col-md-12 mt-2">
                  <label class="text-white">  </label>
                  <div class="d-grid gap-2  d-md-flex justify-content-md-end">
                    <button type="submit" class="btn btn-me shadow btn-kirim text-white">Simpan Data</button>
                    <button class="btn btn-me shadow btn-loading d-none text-white" type="button" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Loading...
                      </button>
                  </div>
                </div>
                
              </div>
            </form>
          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
      <div class="col-md-4 d-flex align-items-center">
        <a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
          <!-- <svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"/></svg> -->
        </a>
        <span class="text-muted">&copy; 2024 Puskesmas Trenggalek</span>
      </div>
  
      <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
        <!-- <li class="ms-3"><a class="text-muted" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#twitter"/></svg></a></li> -->
        <li class="ms-3"><a class="text-muted" href="https://pkm-trenggalek.trenggalekkab.go.id/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-globe2" viewBox="0 0 16 16">
          <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m7.5-6.923c-.67.204-1.335.82-1.887 1.855q-.215.403-.395.872c.705.157 1.472.257 2.282.287zM4.249 3.539q.214-.577.481-1.078a7 7 0 0 1 .597-.933A7 7 0 0 0 3.051 3.05q.544.277 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9 9 0 0 1-1.565-.667A6.96 6.96 0 0 0 1.018 7.5zm1.4-2.741a12.3 12.3 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332M8.5 5.09V7.5h2.99a12.3 12.3 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.6 13.6 0 0 1 7.5 10.91V8.5zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741zm-3.282 3.696q.18.469.395.872c.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a7 7 0 0 1-.598-.933 9 9 0 0 1-.481-1.079 8.4 8.4 0 0 0-1.198.49 7 7 0 0 0 2.276 1.522zm-1.383-2.964A13.4 13.4 0 0 1 3.508 8.5h-2.49a6.96 6.96 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667m6.728 2.964a7 7 0 0 0 2.275-1.521 8.4 8.4 0 0 0-1.197-.49 9 9 0 0 1-.481 1.078 7 7 0 0 1-.597.933M8.5 11.909v3.014c.67-.204 1.335-.82 1.887-1.855q.216-.403.395-.872A12.6 12.6 0 0 0 8.5 11.91zm3.555-.401c.57.185 1.095.409 1.565.667A6.96 6.96 0 0 0 14.982 8.5h-2.49a13.4 13.4 0 0 1-.437 3.008M14.982 7.5a6.96 6.96 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008zM11.27 2.461q.266.502.482 1.078a8.4 8.4 0 0 0 1.196-.49 7 7 0 0 0-2.275-1.52c.218.283.418.597.597.932m-.488 1.343a8 8 0 0 0-.395-.872C9.835 1.897 9.17 1.282 8.5 1.077V4.09c.81-.03 1.577-.13 2.282-.287z"/>
        </svg></a></li>
        <li class="ms-3"><a class="text-muted" href="https://www.facebook.com/p/Puskesmas-Trenggalek-100069977124442/?locale=id_ID"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
          <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"/>
        </svg></a></li>
        <li class="ms-3"><a class="text-muted" href="https://www.instagram.com/puskesmas.trenggalek/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16">
          <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"/>
        </svg></a></li>
        <li class="ms-3"><a class="text-muted" href="https://www.youtube.com/@puskesmastrenggalekofficia3097"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-youtube" viewBox="0 0 16 16">
          <path d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.01 2.01 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.01 2.01 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31 31 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.01 2.01 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A100 100 0 0 1 7.858 2zM6.4 5.209v4.818l4.157-2.408z"/>
        </svg></a></li>
      </ul>
    </footer>
  </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

</html>
<script>
  $(document).ready(function () {
        $('.select2').select2({
          theme: 'bootstrap4',
          width: '100%',
          placeholder: 'Pilih opsi',
          allowClear: true,
        });

        async function fetchData(url) {
          const response = await fetch(url);
          return response.json();
        }

        async function loadProvinsi() {
          const provinsiSelect = $('#provinsi');
          const data = await fetchData(
            'https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json'
          );
          data.forEach((prov) => {
            provinsiSelect.append(
              `<option value="${prov.id}">${prov.name}</option>`
            );
          });
          provinsiSelect.trigger('change');
        }

        $('#provinsi').on('change', async function () {
          const idProvinsi = $(this).val();
          const kabupatenSelect = $('#kabupaten');
          kabupatenSelect.empty().append('<option value="">Pilih Kabupaten/Kota</option>');
          if (idProvinsi) {
            const data = await fetchData(
              `https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${idProvinsi}.json`
            );
            data.forEach((kab) => {
              kabupatenSelect.append(
                `<option value="${kab.name}">${kab.name}</option>`
              );
            });
            kabupatenSelect.trigger('change');
          }
        });

        $('#kabupaten').on('change', async function () {
          const idKabupaten = $(this).val();
          const kecamatanSelect = $('#kecamatan');
          kecamatanSelect.empty().append('<option value="">Pilih Kecamatan</option>');
          if (idKabupaten) {
            const data = await fetchData(
              `https://www.emsifa.com/api-wilayah-indonesia/api/districts/${idKabupaten}.json`
            );
            data.forEach((kec) => {
              kecamatanSelect.append(
                `<option value="${kec.name}">${kec.name}</option>`
              );
            });
            kecamatanSelect.trigger('change');
          }
        });

        $('#kecamatan').on('change', async function () {
          const idKecamatan = $(this).val();
          const desaSelect = $('#desa');
          desaSelect.empty().append('<option value="">Pilih Desa/Kelurahan</option>');
          if (idKecamatan) {
            const data = await fetchData(
              `https://www.emsifa.com/api-wilayah-indonesia/api/villages/${idKecamatan}.json`
            );
            data.forEach((desa) => {
              desaSelect.append(
                `<option value="${desa.name}">${desa.name}</option>`
              );
            });
            desaSelect.trigger('change');
          }
        });

        loadProvinsi();
      });
       // Flatpickr Datepicker
       $("#tanggal").flatpickr({
                dateFormat: "Y-m-d", // Format YYYY-MM-DD
                altInput: true,
                altFormat: "d F Y", // Tampilan lebih user-friendly
                disableMobile: true
            });
      document.addEventListener("DOMContentLoaded", function () {
  const form = document.forms["submit-to-google-sheet"];
  const alertBox = document.querySelector(".alert-success");
  const submitButton = document.querySelector(".btn-kirim");
  const loadingButton = document.querySelector(".btn-loading");

  form.addEventListener("submit", function (event) {
    event.preventDefault();

    // Show loading state
    submitButton.classList.add("d-none");
    loadingButton.classList.remove("d-none");
    let nik = "'" + document.getElementById("nik").value; // Tambah tanda petik di depan
    const formData = new FormData(form);
    formData.append("nik", nik);
    const jsonData = {};
    formData.forEach((value, key) => {
      jsonData[key] = value;
    });
    
            
            
    fetch("https://script.google.com/macros/s/AKfycbxeMNOb6KnATCyppjqP2rdH7AAMXR-BfKvtutXyi2IdhGGflC7Hi_1mfTqRIlEp6xV-/exec", {
      method: "POST",
      mode: "no-cors", // Disable CORS restrictions
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(jsonData),
    })
      .then(() => {
        // Assume success since 'no-cors' prevents response access
        alertBox.classList.remove("d-none");
        // Berhasil: tampilkan SweetAlert
        Swal.fire({
          icon: "success",
          title: "Berhasil!",
          text: "Data telah dikirim.",
          confirmButtonColor: "#3085d6",
          confirmButtonText: "Oke",
        });
        // Reset form
        form.reset();

        // Hide loading, show submit button
        submitButton.classList.remove("d-none");
        loadingButton.classList.add("d-none");

        setTimeout(() => {
          alertBox.classList.add("d-none");
        }, 3000);
      })
      .catch(() => {
        alert("Terjadi kesalahan, coba lagi nanti.");
        submitButton.classList.remove("d-none");
        loadingButton.classList.add("d-none");
      });
  });
});

  </script>
